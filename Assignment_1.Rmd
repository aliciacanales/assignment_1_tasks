---
title: "Assignment_1_tasks"
author: "Alicia Canales"
date: "2023-01-31"
output: 
  html_document:
---

```{r setup, include=FALSE, message=FALSE, echo=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(cowplot)
library(patchwork)
library(tidyverse)
library(lubridate)
library(readxl)
library(here)
library(dplyr)
library(ggplot2)
library(RColorBrewer)
```


```{r}
# reading in the data
frogs <- read_xlsx(here("data", "sierra_amphibians.xlsx"))

# wrangling
yellow_frog <- frogs %>% 
  filter(amphibian_species == "RAMU", amphibian_life_stage != 'EggMass') %>% 
  mutate(date = ymd(survey_date)) %>% 
  mutate(year = year(date)) %>% 
  select(year, amphibian_species, amphibian_life_stage, amphibian_number, lake_id, amphibian_location) %>% 
  group_by(year, amphibian_life_stage)

summary(yellow_frog)
```

```{r}
# creating the graph
yellow_frog_plot <- ggplot(data = yellow_frog, aes(fill = amphibian_life_stage, x = year, y = amphibian_number)) + 
  geom_bar(position = 'dodge', stat = 'identity') + 
  scale_x_continuous(breaks = seq(from = 1995, to = 2002)) + 
  labs(x = "Year", y = "Frog Count", title = "Mountain yellow-legged frog (Rana muscosa) count by life stage from 1995 to 2002", fill = "Life Stage") + scale_fill_manual(values = c("hotpink", "lightblue", "forestgreen")) +
  theme_bw()
yellow_frog_plot

```

```{r}
# going to wrangle more data by removing tadpoles from levels
t5_sub_and_adult_y <- yellow_frog %>% 
  filter(amphibian_life_stage != 'Tadpole') %>% 
  group_by(lake_id) %>% 
  drop_na() %>% 
  summarise(total_frogs = sum(amphibian_number)) %>% 
  slice_max(total_frogs, n = 5) %>% 
  arrange(-total_frogs) # in high-to-low

t5_rename <- t5_sub_and_adult_y %>% 
  mutate(lake_id = factor(lake_id),
         lake_id = c("Lake 50183",
                    "Lake 10223",
                    "Lake 10329",
                    "Lake 20196",
                    "Lake 10225"))
```

```{r}
#plotting the top 5 lakes with the most frog counts
lake_plot <- ggplot(data = t5_rename, aes(x = fct_reorder(lake_id, total_frogs), y = total_frogs, fill = total_frogs)) + labs(x = "Lake Identification", y = "Combined Adult and Subadult frog count", title = "Total count of combined adult and subadult endangered mountain yellow-legged frogs in 5 lakes", fill = "Total Frogs") + scale_fill_gradient(low = "blue", high = "green") + geom_col()
lake_plot
```

```{r}
# Combining two graphs into single figure 
plot_grid(yellow_frog_plot,lake_plot,
          nrows = 1,
          ncol = 2,
          labels = c('A','B'),
          align = "hv")
```


















